# 个人工序记录 App 开发规划

## 1. 项目概述
**目标**：开发一款简单易用的 Android App，帮助个人用户记录每日生产工序、数量及工时，自动计算收入，并提供统计分析功能。
**技术栈**：Kotlin, Jetpack Compose (UI), Room (本地数据库), Navigation Compose.

## 2. 核心功能模块

### 2.1 工序管理 (基础数据)
- **功能**：用户需要先定义“工序”，才能进行记录。
- **操作**：
    - 新增工序（名称、单价、单位 - 如：元/件、元/小时）。
    - 编辑/删除工序。
    - 列表展示所有工序。

### 2.2 记工 (核心业务)
- **功能**：记录某天的生产情况。
- **流程**：
    1. 选择日期（默认今日）。
    2. 输入/选择款号。
    3. 选择工序（从已定义的工序列表中选）。
    4. 输入数量。
    5. 设置时间：
       - 开始时间
       - 结束时间
    6. 自动计算金额（数量 * 单价）。
    7. 添加备注（可选）。
    8. 保存记录。
- **特性**：支持备注、支持修改/删除记录、时间段记录。

### 2.3 统计报表 (数据可视化)
- **首页概览**：
    - 今日收入总额。
    - 本月收入总额。
    - 最近几条记录列表（显示款号、工序、数量、金额）。
- **明细查询**：
    - 按日期筛选查看历史记录。
    - 按月份查看每日汇总。
    - 按款号统计产量/收入。

### 2.4 设置与扩展
- 数据导出（CSV/Excel）。
- 简单的个人设置。

## 3. 数据库设计 (Schema)

我们将使用 Room 数据库，包含两张核心表。

### 表 1: `Process` (工序基础信息表)
| 字段名 | 类型 | 说明 |
| :--- | :--- | :--- |
| `id` | Long (PK) | 自增主键 |
| `name` | String | 工序名称 (如: "车缝", "打包") |
| `defaultPrice` | Double | 默认单价 |
| `unit` | String | 单位 (如: "件", "小时", "个") |
| `isActive` | Boolean | 是否启用 |

### 表 2: `WorkRecord` (工作记录表)
| 字段名 | 类型 | 说明 |
| :--- | :--- | :--- |
| `id` | Long (PK) | 自增主键 |
| `processId` | Long (FK) | 关联 `Process.id` (可选，若需解耦可仅存名称) |
| `processName` | String | 工序名称 (快照) |
| `style` | String | **款号** (新增) |
| `unitPrice` | Double | **单价** (快照，允许修改) |
| `quantity` | Double | **数量** |
| `amount` | Double | 金额 (单价 * 数量) |
| `startTime` | Long | **开始时间** (时间戳) |
| `endTime` | Long | **结束时间** (时间戳) |
| `remark` | String | **备注** |
| `date` | Long | 记录归属日期 (用于统计) |
| `createTime` | Long | 创建时间戳 |

## 4. UI 页面规划 (Navigation)

1.  **Home (首页)**
    *   顶部卡片：今日/本月收入。
    *   列表：今日记录流水 (卡片显示：款号 | 工序 | 数量 | 金额)。
2.  **Record (记工页)**
    *   表单：
        - 日期选择
        - 款号输入 (带历史提示)
        - 工序选择 (下拉/弹窗)
        - 单价输入 (默认带出，可改)
        - 数量输入
        - 时间段选择 (开始/结束)
        - 备注输入
    *   操作：保存按钮。
3.  **ProcessManagement (工序管理页)**
    *   列表：展示所有工序。
    *   新增/编辑：工序表单。
4.  **Statistics (统计页)**
    *   日历视图或列表视图，展示每日汇总。

## 5. 开发步骤

### Phase 1: 基础架构 (当前阶段)
- [ ] 配置 Gradle 依赖 (Room, Navigation, Compose Icons)。
- [ ] 建立包结构 (`data`, `ui`, `model`)。

### Phase 2: 数据层实现
- [ ] 定义 `Process` 和 `WorkRecord` 实体类。
- [ ] 编写 `AppDatabase` 和 `Dao` 接口。
- [ ] 创建 `Repository` 封装数据操作。

### Phase 3: 工序管理功能
- [ ] UI: 工序列表页、添加/编辑工序对话框。
- [ ] Logic: 实现工序的增删改查 ViewModel。

### Phase 4: 记工功能
- [ ] UI: 首页布局、记工输入界面。
- [ ] Logic: 记录保存、关联工序、自动计算金额。

### Phase 5: 统计与优化
- [ ] UI: 统计页面、日期筛选。
- [ ] Logic: 聚合查询（按月/日汇总）。
- [ ] 导出功能 (可选)。

---
*该文件将随项目进度更新*
